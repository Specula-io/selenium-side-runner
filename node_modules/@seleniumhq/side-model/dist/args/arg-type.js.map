{"version":3,"sources":["../../src/args/arg-type.ts"],"names":["ArgType","constructor","args","isRequired","required","identify","value","result","find","arg","TypeError","length","map","name","validate","undefined","exact","oneOf"],"mappings":";;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAIe,MAAMA,OAAN,CAA8C;AAI3DC,EAAAA,WAAW,CAACC,IAAD,EAAU;AAAA;;AAAA,sCAFV,KAEU;;AACnB,SAAKA,IAAL,GAAYA,IAAZ;AACD;;AAEDC,EAAAA,UAAU,GAAG;AACX,SAAKC,QAAL,GAAgB,IAAhB;AAEA,WAAO,IAAP;AACD;;AAEDC,EAAAA,QAAQ,CAACC,KAAD,EAA+C;AACrD,UAAMC,MAAM,GAAG,KAAKL,IAAL,CAAUM,IAAV,CAAeC,GAAG,IAAIA,GAAG,CAACJ,QAAJ,CAAaC,KAAb,CAAtB,CAAf;;AAEA,QAAI,CAACC,MAAL,EAAa;AACX,YAAM,IAAIG,SAAJ,CACH,sCACC,KAAKR,IAAL,CAAUS,MAAV,KAAqB,CAArB,GAAyB,SAAzB,GAAqC,EACtC,GAAE,KAAKT,IAAL,CAAUU,GAAV,CAAcH,GAAG,IAAI,MAAMA,GAAG,CAACI,IAA/B,CAAqC,GAHpC,CAAN;AAKD;;AAED,WAAON,MAAP;AACD;;AAEDO,EAAAA,QAAQ,CAACR,KAAD,EAAqC;AAC3C,QAAI,KAAKF,QAAL,IAAiBE,KAAK,KAAKS,SAA/B,EAA0C;AACxC,YAAM,IAAIL,SAAJ,CAAc,sBAAd,CAAN;AACD;;AACD,WACG,CAAC,KAAKN,QAAN,IAAkBE,KAAK,KAAKS,SAA7B,IACCT,KAAK,KAAKS,SAAV,IAAuB,KAAKV,QAAL,CAAcC,KAAd,EAAqBQ,QAArB,CAA8BR,KAA9B,CAF1B;AAID;;AAED,SAAOU,KAAP,CAA2CP,GAA3C,EAAmD;AACjD,WAAO,IAAIT,OAAJ,CAAY,CAACS,GAAD,CAAZ,CAAP;AACD;;AAED,SAAOQ,KAAP,CAA6Cf,IAA7C,EAAsD;AACpD,WAAO,IAAIF,OAAJ,CAAYE,IAAZ,CAAP;AACD;;AA5C0D","sourcesContent":["// Licensed to the Software Freedom Conservancy (SFC) under one\n// or more contributor license agreements.  See the NOTICE file\n// distributed with this work for additional information\n// regarding copyright ownership.  The SFC licenses this file\n// to you under the Apache License, Version 2.0 (the\n// \"License\"); you may not use this file except in compliance\n// with the License.  You may obtain a copy of the License at\n//\n//   http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing,\n// software distributed under the License is distributed on an\n// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n// KIND, either express or implied.  See the License for the\n// specific language governing permissions and limitations\n// under the License.\n\nimport Argument from './argument'\n\nexport default class ArgType<T extends Argument<any, any>[]> {\n  readonly args: T\n  required = false\n\n  constructor(args: T) {\n    this.args = args\n  }\n\n  isRequired() {\n    this.required = true\n\n    return this\n  }\n\n  identify(value: ExtractArgument<T[number]>): T[number] {\n    const result = this.args.find(arg => arg.identify(value))\n\n    if (!result) {\n      throw new TypeError(\n        `Unexpected input received, expected${\n          this.args.length !== 1 ? ' one of' : ''\n        }${this.args.map(arg => ' ' + arg.name)}.`\n      )\n    }\n\n    return result\n  }\n\n  validate(value?: ExtractArgument<T[number]>) {\n    if (this.required && value === undefined) {\n      throw new TypeError('Argument is required')\n    }\n    return (\n      (!this.required && value === undefined) ||\n      (value !== undefined && this.identify(value).validate(value))\n    )\n  }\n\n  static exact<S extends Argument<any, any>>(arg: S) {\n    return new ArgType([arg])\n  }\n\n  static oneOf<S extends Argument<any, any>[]>(args: S) {\n    return new ArgType(args)\n  }\n}\n\nexport type ExtractArgument<A> = A extends Argument<infer B, any> ? B : never\n"],"file":"arg-type.js"}